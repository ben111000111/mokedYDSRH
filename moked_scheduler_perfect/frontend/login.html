<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>×›× ×™×¡×” | ××¢×¨×›×ª ××•×§×“</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;600;800;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    *{font-family:Heebo,system-ui,-apple-system,Segoe UI,Arial,sans-serif;}
  </style>
</head>

<body class="min-h-screen bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-50 via-slate-100 to-slate-200 flex items-center justify-center p-4">
  <div id="toast" style="display:none;"></div>

  <div class="w-full max-w-md bg-white/80 backdrop-blur rounded-[28px] shadow-xl border border-white p-6 relative overflow-hidden">
    <!-- Brand watermark -->
    <div class="absolute inset-0 flex items-center justify-center opacity-[0.06] pointer-events-none">
      <div class="text-8xl font-black tracking-tight" id="wm">YSB</div>
    </div>

    <div class="relative">
      <div class="flex items-center gap-3 mb-6">
        <div id="logo" class="h-10"></div>
        <div>
          <div class="text-xl font-black text-slate-900" id="appName">××¢×¨×›×ª ××•×§×“</div>
          <div class="text-sm font-bold text-slate-500" id="tagline">× ×™×”×•×œ ×¡×™×“×•×¨ â€¢ ×‘×§×©×•×ª â€¢ ×©×™×‘×•×¥</div>
        </div>
      </div>

      <div id="status" class="text-sm font-bold text-slate-500 mb-4">×‘×•×“×§ ×—×™×‘×•×¨â€¦</div>

      <div class="grid grid-cols-2 gap-2 mb-4">
        <button id="tab-login" class="py-2.5 rounded-2xl bg-slate-900 text-white font-extrabold">×›× ×™×¡×”</button>
        <button id="tab-reg" class="py-2.5 rounded-2xl bg-slate-200 text-slate-900 font-extrabold">×¨×™×©×•×</button>
      </div>

      <form id="loginForm" class="space-y-3">
        <input id="login" class="w-full p-3 rounded-2xl border border-slate-200 bg-white font-bold" placeholder="×˜×œ×¤×•×Ÿ ××• ××™×™×œ" />
        <input id="pass" type="password" class="w-full p-3 rounded-2xl border border-slate-200 bg-white font-bold" placeholder="×¡×™×¡××”" />
        <button class="w-full py-3 rounded-2xl bg-gradient-to-l from-blue-600 to-indigo-600 text-white font-black">
          ×”×ª×—×‘×¨×•×ª
        </button>
      </form>

      <form id="regForm" class="space-y-3 hidden">
        <input id="name" class="w-full p-3 rounded-2xl border border-slate-200 bg-white font-bold" placeholder="×©× ××œ×" />
        <input id="phone" class="w-full p-3 rounded-2xl border border-slate-200 bg-white font-bold" placeholder="×˜×œ×¤×•×Ÿ" />
        <input id="email" class="w-full p-3 rounded-2xl border border-slate-200 bg-white font-bold" placeholder="××™×™×œ (×¨×©×•×ª)" />
        <input id="rpass" type="password" class="w-full p-3 rounded-2xl border border-slate-200 bg-white font-bold" placeholder="×¡×™×¡××” (××™× ×™××•× 4)" />
        <button class="w-full py-3 rounded-2xl bg-gradient-to-l from-emerald-600 to-teal-600 text-white font-black">
          ×©×œ×— ×‘×§×©×”
        </button>
      </form>

      <div id="msg" class="mt-4 text-sm font-bold"></div>

      <div class="mt-6 text-xs font-bold text-slate-500 leading-relaxed">
        * ×¨×§ ××©×ª××© ×©××•×©×¨ ×¢×´×™ ××—××´×© ×™×›×•×œ ×œ×”×™×›× ×¡ ×œ××¢×¨×›×ª.
      </div>
    </div>
  </div>

<script type="module">
  import { CONFIG } from "./config.js";
  import { loadLogo, apiGet, apiPost, setSession, toast } from "./app.js";

  document.getElementById("wm").textContent = CONFIG.LOGO_TEXT;
  document.getElementById("appName").textContent = CONFIG.APP_NAME;
  document.getElementById("tagline").textContent = CONFIG.BRAND_TAGLINE;

  loadLogo(document.getElementById("logo"));

  const status = document.getElementById("status");
  try {
    const r = await apiGet("health");
    if (r.ok) {
      status.textContent = "××—×•×‘×¨ âœ”";
      status.className = "text-sm font-black text-emerald-700 mb-4";
    } else {
      status.textContent = "×©×’×™××ª ×—×™×‘×•×¨";
      status.className = "text-sm font-black text-rose-700 mb-4";
    }
  } catch {
    status.textContent = "×œ× × ×™×ª×Ÿ ×œ×”×ª×—×‘×¨ ×œ×©×¨×ª";
    status.className = "text-sm font-black text-rose-700 mb-4";
  }

  const loginForm = document.getElementById("loginForm");
  const regForm = document.getElementById("regForm");

  document.getElementById("tab-login").onclick = () => {
    loginForm.classList.remove("hidden");
    regForm.classList.add("hidden");
    document.getElementById("msg").textContent = "";
  };
  document.getElementById("tab-reg").onclick = () => {
    regForm.classList.remove("hidden");
    loginForm.classList.add("hidden");
    document.getElementById("msg").textContent = "";
  };

  loginForm.onsubmit = async (e) => {
    e.preventDefault();
    const msg = document.getElementById("msg");
    msg.className = "mt-4 text-sm font-black text-slate-500";
    msg.textContent = "××ª×—×‘×¨â€¦";
    const r = await apiPost("login", {
      login: document.getElementById("login").value.trim(),
      password: document.getElementById("pass").value
    });
    if (!r.ok) {
      msg.className = "mt-4 text-sm font-black text-rose-700";
      msg.textContent = r.error || "×©×’×™××” ×‘×”×ª×—×‘×¨×•×ª";
      return;
    }
    setSession(r.token, r.user);
    toast("×‘×¨×•×š ×”×‘× ğŸ‘‹", "ok");
    window.location.href = "schedule.html";
  };

  regForm.onsubmit = async (e) => {
    e.preventDefault();
    const msg = document.getElementById("msg");
    msg.className = "mt-4 text-sm font-black text-slate-500";
    msg.textContent = "×©×•×œ×— ×‘×§×©×”â€¦";
    const r = await apiPost("register", {
      name: document.getElementById("name").value.trim(),
      phone: document.getElementById("phone").value.trim(),
      email: document.getElementById("email").value.trim(),
      password: document.getElementById("rpass").value
    });
    if (!r.ok) {
      msg.className = "mt-4 text-sm font-black text-rose-700";
      msg.textContent = r.error || "×©×’×™××” ×‘×¨×™×©×•×";
      return;
    }
    msg.className = "mt-4 text-sm font-black text-emerald-700";
    msg.textContent = "× ×©×œ×—. ×××ª×™×Ÿ ×œ××™×©×•×¨ ××—××´×©.";
    toast("× ×¨×©××ª âœ” ×××ª×™×Ÿ ×œ××™×©×•×¨", "ok");
  };
</script>
</body>
</html>
